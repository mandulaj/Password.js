function Password(t,r,s){this.defaultOpts={commonWords:["password","123456","secret"],minWordDistance:3,complexity:5},"function"==typeof r&&(s=r,r={}),r=r||{},this.opts=this._mergeOpts(r,this.defaultOpts),this.cb=s||null,this.password=t,null!==this.cb&&this.cb(this.profile())}Password.prototype={update:function(t,r){this.password=t,r=r||{},this.opts=this._mergeOpts(r,this.opts),null!==this.cb&&this.cb(this.profile())},profile:function(){return this.password},getWordStrength:function(){var t="",r=0;for(r in this.opts.commonWords)if(t=this.opts.commonWords[r],this._vagueMatch(this.password,t))return!1;return!0},getCharSet:function(){var t=0,r=this.password;r.match(/[a-z]/)&&(t+=26),r.match(/[A-Z]/)&&(t+=26),r.match(/[0-9]/)&&(t+=10),r.match(/[@!#$%^&*()]/)&&(t+=10),r.match(/['"`~\-=+\[\]{}\\|;:,<.>/?]/)&&(t+=20),r.match(/\s/)&&(t+=1);for(var s={191:!0,687:!0,879:!0},o=0,e=r.length;e>o;o++){var n=r.charCodeAt(o);126>=n||(s[191]&&191>=n?(t+=32,s[191]=!1):s[687]&&687>=n?(t+=495,s[697]=!1):s[879]&&879>=n&&(t+=292,s[879]=!1))}return t},getEntropy:function(){var t=this.password,r=this.getCharSet(),s=t.length;return s*(Math.log(r)/Math.log(2))},clean:function(){this.password=""},_mergeOpts:function(t,r){for(var s in r)typeof t[s]==typeof r[s]&&(r[s]=t[s]);return r},_vagueMatch:function(t,r){t=t.toLowerCase();var s=t.length-r.length;if(0>=s)return this._levenshteinDist(t,r);for(var o=0,e="",n=0;n+r.length<=t.length;n++)if(e=t.substr(n,r.length),o=this._levenshteinDist(e,r),o<=this.opts.minWordDistance)return!0;return!1},_levenshteinDist:function(t,r){var s,o,e=[],n=t.length,i=r.length;if(0===n)return i;if(0===i)return n;for(s=n;s>=0;s--)e[s]=[];for(s=n;s>=0;s--)e[s][0]=s;for(o=i;o>=0;o--)e[0][o]=o;for(s=1;n>=s;s++){var h=t.charAt(s-1);for(o=1;i>=o;o++){if(s==o&&e[s][o]>4)return n;var a=r.charAt(o-1),c=h==a?0:1,u=e[s-1][o]+1,f=e[s][o-1]+1,p=e[s-1][o-1]+c;u>f&&(u=f),u>p&&(u=p),e[s][o]=u,s>1&&o>1&&h==r.charAt(o-2)&&t.charAt(s-2)==a&&(e[s][o]=Math.min(e[s][o],e[s-2][o-2]+c))}}return e[n][i]}},module?module.exports=Password:window.Password=Password;